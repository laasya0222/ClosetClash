extends layout

block content
  .container.stats-page
    h1.text-center.mb-5 #{title}
    
    if !stats || stats.numOutfits === 0
      .text-center
        p.lead You don't have any stats yet.
        a.btn.btn-primary(href="/closet") Upload an Outfit to Get Started!
    else
      //- Stat Cards
      .row.g-4.text-center.mb-5
        .col-md-6.col-lg-3
          .card.h-100.stat-card
            .card-body
              h5.card-title Total Outfits
              p.card-text.display-4.fw-bold= stats.numOutfits
        .col-md-6.col-lg-3
          .card.h-100.stat-card
            .card-body
              h5.card-title Overall Win Rate
              - const overallWinRate = stats.totalBattles > 0 ? ((stats.totalWins / stats.totalBattles) * 100).toFixed(0) : 0
              p.card-text.display-4.fw-bold #{overallWinRate}%
        .col-md-6.col-lg-3
          .card.h-100.stat-card
            .card-body
              h5.card-title Best Outfit
              if stats.bestOutfit
                p.card-text.fw-bold= stats.bestOutfit.name
                - const bestWinRate = stats.bestOutfit.battlesPlayed > 0 ? ((stats.bestOutfit.wins / stats.bestOutfit.battlesPlayed) * 100).toFixed(0) : 0
                p.text-success (#{bestWinRate}% Win Rate)
              else
                p.text-muted N/A
        .col-md-6.col-lg-3
          .card.h-100.stat-card
            .card-body
              h5.card-title Most Liked
              if stats.mostLikedOutfit
                p.card-text.fw-bold= stats.mostLikedOutfit.name
                p.text-danger
                  i.fas.fa-heart
                  |  #{stats.mostLikedOutfit.likes || 0}
              else
                p.text-muted N/A

      //- Detailed Outfit Table
      hr
      h2.mt-5.mb-4 Detailed Stats
      .table-responsive
        table.table.table-hover.align-middle
          thead
            tr
              th Outfit
              th Name
              th Wins
              th Battles
              th Win Rate
              th Likes
          tbody
            each outfit in userOutfits
              tr
                td
                  img(src=outfit.image, alt=outfit.name, style="width: 50px; height: 50px; object-fit: cover; border-radius: 5px;")
                td= outfit.name
                td= outfit.wins || 0
                td= outfit.battlesPlayed || 0
                td #{outfit.winRate.toFixed(0)}%
                td= outfit.likes || 0